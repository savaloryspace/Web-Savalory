<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Savalory F&B System</title>

<style>
/* === GLOBAL STYLE ===== */
:root {
  --primary: #ff9900;
  --bg: #ffffff;
  --text: #222;
  --card: #f5f5f5;
}
.dark {
  --bg: #111;
  --text: #fff;
  --card: #222;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}

/* HEADER */
header {
  display: flex;
  justify-content: space-between;
  padding: 15px;
  background: var(--primary);
  color: #fff;
  font-size: 20px;
  font-weight: bold;
}

/* CART ICON */
#cartIcon {
  cursor: pointer;
  position: relative;
}
#cartCount {
  background: red;
  padding: 2px 7px;
  border-radius: 50%;
  position: absolute;
  top: -8px;
  right: -8px;
  font-size: 12px;
}

/* MENU LIST */
.menu-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 10px;
  padding: 10px;
}
.menu-card {
  background: var(--card);
  border-radius: 8px;
  padding: 10px;
  text-align: center;
  position: relative;
}
.menu-card button {
  padding: 8px;
  background: var(--primary);
  border: none;
  border-radius: 6px;
  color: white;
  cursor: pointer;
}
.soldout-label {
  background: red;
  color: white;
  padding: 3px 6px;
  font-size: 13px;
  border-radius: 4px;
  position: absolute;
  top: 5px;
  right: 5px;
}

/* CART POPUP */
#popupCart {
  position: fixed;
  bottom: 0;
  right: 0;
  width: 340px;
  height: 430px;
  background: var(--card);
  border-radius: 12px;
  display: none;
  flex-direction: column;
  padding: 15px;
  border: 2px solid var(--primary);
}
input, select {
  width: 100%;
  padding: 8px;
  margin-top: 6px;
  border-radius: 5px;
}

/* ADMIN PANEL */
#adminPanel {
  display: none;
  padding: 20px;
}
</style>
</head>
<body>

<header>
  SAVALORY
  <div>
    <span id="cartIcon">üõí <span id="cartCount">0</span></span>
    <button onclick="toggleTheme()">üåô</button>
    <button onclick="openAdmin()">‚öôÔ∏è</button>
  </div>
</header>

<!-- MENU LIST -->
<div class="menu-container" id="menuList"></div>

<!-- CART POPUP -->
<div id="popupCart">
  <h3>Checkout Pesanan</h3>

  <div id="cartItems"></div>
  <p><b>Total: Rp <span id="totalHarga">0</span></b></p>

  <input id="nama" placeholder="Nama pelanggan" />
  <input id="meja" placeholder="No Meja / Take Away" />
  <input id="wa" placeholder="No Whatsapp" />

  <button style="margin-top: 10px; background: green; color: white; padding: 12px; border-radius: 8px;">
    Selesaikan Pesanan
  </button>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel">
  <h2>ADMIN PANEL</h2>
  <select id="kategoriAdd">
    <option value="makanan">Makanan</option>
    <option value="minuman">Minuman</option>
  </select>
  <input id="menuAdd" placeholder="Nama menu">
  <input id="priceAdd" placeholder="Harga">
  <button onclick="addMenu()">Tambah Menu</button>

  <h3>Daftar Menu</h3>
  <div id="adminList"></div>
</div>


<script>
/*================ LOCAL STORAGE =================*/
function getMenuDB() {
  return JSON.parse(localStorage.getItem("menuDB")) || [];
}
function saveMenuDB(data){
  localStorage.setItem("menuDB", JSON.stringify(data));
}

/*=============== LOAD MENU =================*/
function renderMenu() {
  let menu = getMenuDB();
  let html = "";

  menu.forEach((item, index) => {
    html += `
      <div class="menu-card">
        ${item.soldout ? `<span class="soldout-label">SOLD OUT</span>` : ""}
        <h4>${item.nama}</h4>
        <p>Rp ${item.harga.toLocaleString()}</p>
        <button ${item.soldout ? "disabled" : ""} onclick="addToCart(${index})">+</button>
      </div>`;
  });

  document.getElementById("menuList").innerHTML = html;
}

/*=============== ADD MENU FROM ADMIN =================*/
function addMenu() {
  let nama = menuAdd.value;
  let harga = Number(priceAdd.value);
  let kategori = kategoriAdd.value;

  if (!nama || !harga) return alert("Isi nama & harga");

  let menu = getMenuDB();
  menu.push({ nama, harga, kategori, soldout: false });
  saveMenuDB(menu);
  renderMenu();
  renderAdminMenu();
}

/*=============== RENDER ADMIN MENU =================*/
function renderAdminMenu(){
  let menu = getMenuDB();
  let html = "";

  menu.forEach((item, index)=>{
    html += `
      <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
        ${item.nama} (Rp ${item.harga})
        <button onclick="toggleSold(${index})">
          ${item.soldout ? "Buka" : "Sold Out"}
        </button>
      </div>`;
  });

  adminList.innerHTML = html;
}

/*=============== SOLD OUT TOGGLE =================*/
function toggleSold(i){
  let db = getMenuDB();
  db[i].soldout = !db[i].soldout;
  saveMenuDB(db);
  renderMenu();
  renderAdminMenu();
}

/*=============== CART =================*/
let cart = [];

function addToCart(i){
  let cartIcon = document.getElementById("cartIcon");
  let clone = cartIcon.cloneNode(true);
  document.body.appendChild(clone);

  clone.style.position = "absolute";
  clone.style.transition = "0.6s";
  clone.style.left = "50%";
  clone.style.top = "60%";

  setTimeout(()=> clone.style.top = "0px", 10);
  setTimeout(()=> clone.remove(), 600);

  cart.push(getMenuDB()[i]);
  document.getElementById("cartCount").innerHTML = cart.length;
}

/*=============== CART POPUP SHOW =================*/
cartIcon.onclick = () =>{
  popupCart.style.display = "flex";
  renderCart();
};

function renderCart(){
  let total = 0;
  let html = "";
  cart.forEach(item=>{
    total += item.harga;
    html += `<p>${item.nama} - Rp ${item.harga.toLocaleString()}</p>`;
  });

  document.getElementById("totalHarga").innerHTML = total.toLocaleString();
  document.getElementById("cartItems").innerHTML = html;
}

/* DARK MODE */
function toggleTheme(){
  document.body.classList.toggle("dark");
}

/* OPEN ADMIN */
function openAdmin(){
  adminPanel.style.display = adminPanel.style.display === "block" ? "none" : "block";
  renderAdminMenu();
}

/* FIRST LOAD */
renderMenu();
renderAdminMenu();
</script>

</body>
</html>
